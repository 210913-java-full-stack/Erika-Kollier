<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <title>Train Co.</title>
  </head>
  <body>
    <style>
      input#password {
        position: relative;
        top:2px;
      }

      input#password,
      #username {
        padding: 15px;
      }

      div.text-center.mt-5 {
        position: relative;
        top: 60px;
      }

      button.btn.btn-primary {
        padding: 10px 50px;
      }

      a {
        position: relative;
        top: 10px;
      }

      div.container{
        position: relative;
        top:20px;
      }

  
    </style>

    <div class="text-center mt-5">
      <form style="max-width: 280px; margin: auto">
        <h1 class="h2 mt-3 font-weight-normal">Sign in</h1>
        <div class = "container">
        <label for="username" class="visually-hidden">Username</label>
        <input
          type="text"
          id="username"
          name="username"
          class="form-control"
          placeholder="Username"
          value=""
          required
          autofocus
        />
        <label for="inputpassword2" class="visually-hidden">Password</label>
        <input
          type="password"
          id="password"
          name="password"
          class="form-control"
          placeholder="Password"
          value=""
          required
          autofocus
        />

        <div class="checkout mt-3">
          <label>
            <input type="checkbox" value="remember-me" />Remember me
          </label>
        </div>

        <div class="d-grid gap-2 mt-3">
          <button class="btn btn-primary" type="button" onclick="userLogin()" >Sign in</button>
        </div>
        <a href="register.html">Don't have an account? Sign up</a>
      </div>
        </div>
      </form>
    </div>

  
    <script>
     
          /**
    * User Login function if access token doesn't return, need to pass a grant_Type param
    * When User logs in payload should return with an Access Token
    * Token will be stored in the local storage
    * First create variables to pull information from the DOM to use within fetch. Those vairables are within the form element. userData variable containes the userInfo object containing the data the user inputs.
     * fetch from the loginUrl using the POST method and set the headers sets the Content type to expect JSON
     * body is set to the userData variable, which will turn into a JSON string
     * sned a reponse and the result will be JSON
     * the access token is set to the token varaible
     * setItem method sets the token to the local storage
     * call the tokenChecker function
      */
  
    
    
    function userLogin() {
      let userUsername = document.getElementById("username").value;
      let userPassword = document.getElementById("password").value;
      console.log(userUsername, userPassword);
    
      let userData = { users: { username: userUsername, password: userPassword } };
      console.log(
        `userInfo = ${userData.users.username} ${userData.users.password}`
      );
    
      let loginUrl = "http://localhost:8080/Erika-Kollier/login";


      let response = fetch(loginUrl, {
        method: "POST",
        headers: {
          "Content-Type": "application/json;charset=utf-8",
        },
        body: JSON.stringify(userData)
      }).then((response) => {
        let result = response.json();
        console.log(response.accessToken)
        let token = response.accessToken
        localStorage.setItem('AccessToken', token)
        console.log(userData)
      }).catch((error) => {
        console.log(error);
      })
    }
    </script>
    

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
      integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
      integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
    
<!-- //   fetch(loginUrl, {
  //   method: "POST",
  //   headers: {
  //     "Content-Type": "application/json;charset=utf-8",
  //   },
  //   body: JSON.stringify(userData)
  // })
  //   .then(response => response.json())
  //   .then(function (response) {
  //       localStorage.setItem('AccessToken', token);
        
  //   })
  //   .catch((err) => {
  //       console.log(err)
  //   }) -->
